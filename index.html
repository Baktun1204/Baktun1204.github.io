<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LS Pure-Ambience</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Pretendard:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
    
    * { font-family: 'Pretendard', -apple-system, sans-serif; }
    .logo-font { font-family: 'Cormorant Garamond', serif; letter-spacing: 0.05em; }
    
    /* Smooth number transitions */
    .num-transition { transition: all 0.4s ease-out; }
    
    /* Pulse animation for connection dot */
    @keyframes pulse-soft {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.1); }
    }
    .pulse-soft { animation: pulse-soft 2s ease-in-out infinite; }
    
    /* Dial pulse animation */
    @keyframes dial-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.92; }
    }
    .dial-pulse { animation: dial-pulse 2s ease-in-out infinite; }
    
    /* Dial dot pulse */
    @keyframes dial-dot-pulse {
      0%, 100% { box-shadow: 0 0 4px rgba(6,182,212,0.6); }
      50% { box-shadow: 0 0 10px rgba(6,182,212,0.9); }
    }
    .dial-dot-pulse { animation: dial-dot-pulse 1.5s ease-in-out infinite; }
    
    /* Indicator ring transition */
    .indicator-ring { transition: stroke-dashoffset 0.6s ease-out; }
    
    /* Fan rotation */
    @keyframes spin-fan {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .fan-spin { animation: spin-fan var(--fan-speed, 2s) linear infinite; }
    
    /* Tab fade transition */
    .tab-content {
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.3s ease-out, transform 0.3s ease-out;
      display: none;
    }
    .tab-content.active {
      opacity: 1;
      transform: translateY(0);
      display: block;
    }
    
    /* Toast animation */
    @keyframes toast-in {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes toast-out {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(100%); opacity: 0; }
    }
    .toast-enter { animation: toast-in 0.3s ease-out forwards; }
    .toast-exit { animation: toast-out 0.3s ease-out forwards; }
    
    /* Button press effect */
    .btn-press:active { transform: scale(0.98); }
    
    /* Circular progress */
    .progress-ring { transition: stroke-dashoffset 0.8s ease-out; }
    
    /* Level meter animation */
    @keyframes meter-bounce {
      0%, 100% { height: var(--base-height, 30%); }
      50% { height: var(--peak-height, 60%); }
    }
    .meter-bar {
      animation: meter-bounce var(--meter-speed, 0.8s) ease-in-out infinite;
    }
    
    /* Glassmorphism card */
    .glass-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(15, 23, 42, 0.15); border-radius: 4px; }
    
    /* Live indicator */
    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    .live-blink { animation: blink 1.5s ease-in-out infinite; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4" style="background: #111;">
  
  <!-- App Container -->
  <div id="app" class="relative w-full max-w-[400px] min-h-[850px] rounded-[24px] overflow-hidden shadow-2xl"
       style="background: linear-gradient(180deg, #FAFBFC 0%, #F1F5F9 100%);">
    
    <!-- Header -->
    <header class="sticky top-0 z-50 px-5 py-4 flex items-center justify-between glass-card border-b"
            style="border-color: rgba(15,23,42,0.06);">
      <button class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-slate-100 transition btn-press">
        <i class="fa-solid fa-bars text-slate-700"></i>
      </button>
      
      <h1 class="logo-font text-lg font-medium text-slate-800 tracking-wide">LS Pure-Ambience</h1>
      
      <div class="flex items-center gap-3">
        <div class="flex items-center gap-1.5">
          <span class="w-2 h-2 rounded-full bg-emerald-500 pulse-soft"></span>
          <span class="text-xs text-slate-500 font-medium">연결됨</span>
        </div>
        <div class="flex items-center gap-1 text-slate-500">
          <i class="fa-solid fa-battery-three-quarters text-sm"></i>
          <span class="text-xs font-medium">82%</span>
        </div>
      </div>
    </header>
    
    <!-- Main Content Area -->
    <main class="px-5 pb-28 overflow-y-auto" style="height: calc(850px - 140px);">
      
      <!-- Tab: Home -->
      <div id="tab-home" class="tab-content active pt-5">
        
        <!-- Hero: Protection Dial -->
        <section class="relative rounded-2xl overflow-hidden mb-5 glass-card border py-5 px-4"
                 style="border-color: rgba(15,23,42,0.08);">
          
          <!-- Live indicator -->
          <div class="absolute top-3 right-3 flex items-center gap-1.5 px-2 py-1 rounded-full"
               style="background: rgba(6, 182, 212, 0.1);">
            <span class="w-1.5 h-1.5 rounded-full bg-cyan-500 live-blink"></span>
            <span class="text-[10px] font-semibold text-cyan-600">LIVE</span>
          </div>
          
          <!-- Main Dial + Indicators Row -->
          <div class="flex items-center justify-center gap-6">
            
            <!-- Left Indicator: Noise Control -->
            <div class="flex flex-col items-center">
              <div class="relative w-16 h-16">
                <svg class="w-full h-full transform -rotate-90">
                  <circle cx="32" cy="32" r="26" stroke="rgba(79,70,229,0.12)" stroke-width="5" fill="none"/>
                  <circle id="noise-ring" class="indicator-ring" cx="32" cy="32" r="26" 
                          stroke="#6366F1" stroke-width="5" fill="none"
                          stroke-linecap="round"
                          stroke-dasharray="163.36" stroke-dashoffset="32.67"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <span id="noise-indicator" class="text-lg font-bold text-slate-700">80</span>
                </div>
              </div>
              <span class="text-[10px] font-semibold text-indigo-600 mt-1.5">소음 제어</span>
            </div>
            
            <!-- Main Dial: Shield Index -->
            <div class="relative">
              <div class="relative w-32 h-32">
                <!-- Conic gradient dial -->
                <div id="shield-dial" class="absolute inset-0 rounded-full dial-pulse"
                     style="background: conic-gradient(from 220deg, #06B6D4 0%, #0891B2 calc(var(--shield-progress, 85) * 2.8deg), rgba(15,23,42,0.08) calc(var(--shield-progress, 85) * 2.8deg), rgba(15,23,42,0.08) 280deg, transparent 280deg);
                            mask: radial-gradient(transparent 42px, black 43px, black 56px, transparent 57px);
                            -webkit-mask: radial-gradient(transparent 42px, black 43px, black 56px, transparent 57px);">
                </div>
                <!-- Highlight dot at end -->
                <div id="shield-dot" class="absolute w-2.5 h-2.5 rounded-full bg-cyan-400 shadow-lg dial-dot-pulse"
                     style="top: 8px; left: 50%; transform: translateX(-50%) rotate(calc((var(--shield-progress, 85) * 2.8deg) - 140deg)) translateY(-52px); transform-origin: center 56px;">
                </div>
                <!-- Center content -->
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                  <span id="shield-value" class="text-4xl font-bold text-slate-800">85</span>
                  <span class="text-[9px] font-semibold text-slate-400 tracking-wider">SHIELD INDEX</span>
                </div>
              </div>
            </div>
            
            <!-- Right Indicator: Air Purity -->
            <div class="flex flex-col items-center">
              <div class="relative w-16 h-16">
                <svg class="w-full h-full transform -rotate-90">
                  <circle cx="32" cy="32" r="26" stroke="rgba(6,182,212,0.12)" stroke-width="5" fill="none"/>
                  <circle id="air-ring" class="indicator-ring" cx="32" cy="32" r="26" 
                          stroke="#06B6D4" stroke-width="5" fill="none"
                          stroke-linecap="round"
                          stroke-dasharray="163.36" stroke-dashoffset="16.34"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                  <span id="air-indicator" class="text-lg font-bold text-slate-700">90</span>
                </div>
              </div>
              <span class="text-[10px] font-semibold text-cyan-600 mt-1.5">공기 청정</span>
            </div>
            
          </div>
          
          <!-- Status Section -->
          <div class="mt-4 text-center">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full mb-1.5"
                 style="background: rgba(6,182,212,0.08);">
              <i id="mode-icon-hero" class="fa-solid fa-wand-magic-sparkles text-xs text-cyan-600"></i>
              <span id="current-mode-label" class="text-xs font-semibold text-cyan-700">스마트 벤트</span>
            </div>
            <p id="status-message" class="text-xs text-slate-500 font-medium">실시간 최적화 중</p>
          </div>
          
        </section>
        
        <!-- Dual Status Cards -->
        <div class="grid grid-cols-2 gap-3 mb-5">
          
          <!-- Card A: Noise Control -->
          <div class="glass-card rounded-xl p-4 border" style="border-color: rgba(15,23,42,0.06);">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background: rgba(79,70,229,0.1);">
                <i class="fa-solid fa-shield-halved text-indigo-500 text-sm"></i>
              </div>
              <span class="text-sm font-semibold text-slate-700">소음 제어</span>
            </div>
            <div class="text-xs text-slate-400 mb-1">OUT <span id="noise-out" class="font-medium">82</span> dB</div>
            <div class="text-2xl font-bold text-slate-800 mb-2">
              IN <span id="noise-in" class="num-transition">35</span> <span class="text-base font-medium">dB</span>
            </div>
            <div id="noise-status" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold"
                 style="background: rgba(16,185,129,0.1); color: #059669;">
              <i class="fa-solid fa-check-circle text-[8px]"></i>
              차음 안정
            </div>
          </div>
          
          <!-- Card B: Air Purification -->
          <div class="glass-card rounded-xl p-4 border" style="border-color: rgba(15,23,42,0.06);">
            <div class="flex items-center gap-2 mb-3">
              <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background: rgba(6,182,212,0.1);">
                <i id="fan-icon" class="fa-solid fa-fan text-cyan-500 text-sm fan-spin" style="--fan-speed: 2s;"></i>
              </div>
              <span class="text-sm font-semibold text-slate-700">공기 청정</span>
            </div>
            <div class="flex items-center gap-1 text-xs text-slate-400 mb-1">
              OUT <span id="dust-out" class="font-medium">150</span> ㎍/㎥
              <span class="px-1.5 py-0.5 rounded text-[9px] font-semibold" style="background: rgba(245,158,11,0.15); color: #D97706;">나쁨</span>
            </div>
            <div class="text-2xl font-bold text-slate-800 mb-2">
              IN <span id="dust-in" class="num-transition">8</span> <span class="text-base font-medium">㎍/㎥</span>
            </div>
            <div id="dust-status" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-semibold"
                 style="background: rgba(6,182,212,0.1); color: #0891B2;">
              <i class="fa-solid fa-wind text-[8px]"></i>
              좋음
            </div>
          </div>
        </div>
        
        <!-- Mode Control Center -->
        <section class="glass-card rounded-xl p-4 border" style="border-color: rgba(15,23,42,0.06);">
          <h3 class="text-sm font-semibold text-slate-700 mb-3">운전 모드</h3>
          <div class="grid grid-cols-3 gap-2">
            <button id="mode-bunker" onclick="setMode('bunker')"
                    class="mode-btn relative px-3 py-3 rounded-xl text-center transition-all btn-press"
                    style="background: white; border: 1px solid rgba(15,23,42,0.08);">
              <i class="fa-solid fa-lock text-lg mb-1 text-slate-600"></i>
              <div class="text-xs font-semibold text-slate-600">벙커 모드</div>
            </button>
            <button id="mode-smart" onclick="setMode('smart')"
                    class="mode-btn active relative px-3 py-3 rounded-xl text-center transition-all btn-press"
                    style="background: white; border: 2px solid #06B6D4; box-shadow: 0 0 0 3px rgba(6,182,212,0.15);">
              <i class="fa-solid fa-wand-magic-sparkles text-lg mb-1 text-cyan-600"></i>
              <div class="text-xs font-semibold text-cyan-700">스마트 벤트</div>
            </button>
            <button id="mode-open" onclick="setMode('open')"
                    class="mode-btn relative px-3 py-3 rounded-xl text-center transition-all btn-press"
                    style="background: white; border: 1px solid rgba(15,23,42,0.08);">
              <i class="fa-solid fa-door-open text-lg mb-1 text-slate-600"></i>
              <div class="text-xs font-semibold text-slate-600">안심 개방</div>
            </button>
          </div>
        </section>
      </div>
      
      <!-- Tab: Sound Mixer -->
      <div id="tab-sound" class="tab-content pt-5">
        
        <!-- EQ Section -->
        <section class="glass-card rounded-xl p-5 border mb-4" style="border-color: rgba(15,23,42,0.06);">
          <h3 class="text-sm font-semibold text-slate-700 mb-4">이퀄라이저 조절</h3>
          
          <!-- Level Meters -->
          <div class="flex justify-center gap-2 mb-5 h-20">
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-low-1" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-indigo-500 to-indigo-300 rounded-full" style="--base-height: 25%; --peak-height: 45%; --meter-speed: 0.6s;"></div>
              </div>
            </div>
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-low-2" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-indigo-500 to-indigo-300 rounded-full" style="--base-height: 30%; --peak-height: 55%; --meter-speed: 0.5s; animation-delay: 0.1s;"></div>
              </div>
            </div>
            <div class="w-3"></div>
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-mid-1" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-cyan-500 to-cyan-300 rounded-full" style="--base-height: 35%; --peak-height: 65%; --meter-speed: 0.45s;"></div>
              </div>
            </div>
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-mid-2" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-cyan-500 to-cyan-300 rounded-full" style="--base-height: 40%; --peak-height: 70%; --meter-speed: 0.55s; animation-delay: 0.15s;"></div>
              </div>
            </div>
            <div class="w-3"></div>
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-high-1" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-emerald-500 to-emerald-300 rounded-full" style="--base-height: 20%; --peak-height: 40%; --meter-speed: 0.4s;"></div>
              </div>
            </div>
            <div class="flex flex-col items-center gap-1">
              <div class="relative w-4 h-16 bg-slate-100 rounded-full overflow-hidden">
                <div id="meter-high-2" class="meter-bar absolute bottom-0 w-full bg-gradient-to-t from-emerald-500 to-emerald-300 rounded-full" style="--base-height: 25%; --peak-height: 50%; --meter-speed: 0.35s; animation-delay: 0.2s;"></div>
              </div>
            </div>
          </div>
          
          <!-- EQ Sliders -->
          <div class="space-y-4">
            <div class="flex items-center gap-4">
              <span class="w-10 text-xs font-semibold text-slate-500">Low</span>
              <input type="range" id="eq-low" min="0" max="100" value="50" 
                     class="flex-1 h-2 bg-slate-200 rounded-full appearance-none cursor-pointer accent-indigo-500"
                     onchange="updateEQ('low', this.value)">
              <span id="eq-low-val" class="w-8 text-xs font-semibold text-slate-600 text-right">50</span>
            </div>
            <div class="flex items-center gap-4">
              <span class="w-10 text-xs font-semibold text-slate-500">Mid</span>
              <input type="range" id="eq-mid" min="0" max="100" value="60" 
                     class="flex-1 h-2 bg-slate-200 rounded-full appearance-none cursor-pointer accent-cyan-500"
                     onchange="updateEQ('mid', this.value)">
              <span id="eq-mid-val" class="w-8 text-xs font-semibold text-slate-600 text-right">60</span>
            </div>
            <div class="flex items-center gap-4">
              <span class="w-10 text-xs font-semibold text-slate-500">High</span>
              <input type="range" id="eq-high" min="0" max="100" value="40" 
                     class="flex-1 h-2 bg-slate-200 rounded-full appearance-none cursor-pointer accent-emerald-500"
                     onchange="updateEQ('high', this.value)">
              <span id="eq-high-val" class="w-8 text-xs font-semibold text-slate-600 text-right">40</span>
            </div>
          </div>
        </section>
        
        <!-- Natural Sound Toggle -->
        <section class="glass-card rounded-xl p-4 border mb-4" style="border-color: rgba(15,23,42,0.06);">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-semibold text-slate-700">자연음 패스스루</h3>
              <p class="text-xs text-slate-400 mt-0.5">새소리, 바람 소리 등 자연음을 허용합니다</p>
            </div>
            <button id="toggle-nature" onclick="toggleNature()" 
                    class="relative w-12 h-7 rounded-full transition-all btn-press"
                    style="background: rgba(15,23,42,0.1);">
              <span class="absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow transition-transform"></span>
            </button>
          </div>
        </section>
        
        <!-- Info Text -->
        <p class="text-xs text-slate-400 text-center px-4 leading-relaxed">
          LS Pure-Ambience의 고급 사운드 엔진은<br>외부 소음을 차단하면서도 원하는 소리만 선별적으로 전달합니다.
        </p>
      </div>
      
      <!-- Tab: Filter/Ventilation -->
      <div id="tab-filter" class="tab-content pt-5">
        
        <!-- HEPA Filter Status -->
        <section class="glass-card rounded-xl p-5 border mb-4" style="border-color: rgba(15,23,42,0.06);">
          <h3 class="text-sm font-semibold text-slate-700 mb-4">HEPA 필터 상태</h3>
          
          <div class="flex items-center justify-center mb-4">
            <div class="relative w-36 h-36">
              <svg class="w-full h-full transform -rotate-90">
                <circle cx="72" cy="72" r="60" stroke="rgba(15,23,42,0.08)" stroke-width="10" fill="none"/>
                <circle id="hepa-progress" class="progress-ring" cx="72" cy="72" r="60" 
                        stroke="#06B6D4" stroke-width="10" fill="none"
                        stroke-linecap="round"
                        stroke-dasharray="377" stroke-dashoffset="67.86"/>
              </svg>
              <div class="absolute inset-0 flex flex-col items-center justify-center">
                <span id="hepa-percent" class="text-3xl font-bold text-slate-800">82</span>
                <span class="text-xs text-slate-400">%</span>
              </div>
            </div>
          </div>
          
          <div class="text-center">
            <span id="hepa-status" class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold"
                  style="background: rgba(16,185,129,0.1); color: #059669;">
              <i class="fa-solid fa-check-circle"></i>
              필터 상태 양호
            </span>
          </div>
        </section>
        
        <!-- Fan Speed Control -->
        <section class="glass-card rounded-xl p-5 border mb-4" style="border-color: rgba(15,23,42,0.06);">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-sm font-semibold text-slate-700">환기 팬 속도</h3>
            <span id="fan-level" class="px-3 py-1 rounded-full text-xs font-bold bg-cyan-50 text-cyan-700">3단계</span>
          </div>
          
          <div class="flex items-center gap-4">
            <span class="text-xs font-semibold text-slate-400">1</span>
            <input type="range" id="fan-slider" min="1" max="5" value="3" 
                   class="flex-1 h-2 bg-slate-200 rounded-full appearance-none cursor-pointer accent-cyan-500"
                   onchange="updateFanSpeed(this.value)">
            <span class="text-xs font-semibold text-slate-400">5</span>
          </div>
          
          <div class="flex justify-between mt-2 px-2">
            <span class="text-[10px] text-slate-400">저소음</span>
            <span class="text-[10px] text-slate-400">강력환기</span>
          </div>
        </section>
        
        <!-- Auto Optimization Toggle -->
        <section class="glass-card rounded-xl p-4 border" style="border-color: rgba(15,23,42,0.06);">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-semibold text-slate-700">필터 자동 최적화</h3>
              <p class="text-xs text-slate-400 mt-0.5">실내 공기질에 따라 자동으로 필터 성능을 조절합니다</p>
            </div>
            <button id="toggle-auto" onclick="toggleAuto()" 
                    class="relative w-12 h-7 rounded-full transition-all btn-press"
                    style="background: #06B6D4;">
              <span class="absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow transition-transform" style="transform: translateX(20px);"></span>
            </button>
          </div>
        </section>
      </div>
      
      <!-- Tab: Security Log -->
      <div id="tab-log" class="tab-content pt-5">
        <h3 class="text-sm font-semibold text-slate-700 mb-4">보안 및 활동 로그</h3>
        
        <div id="log-list" class="space-y-3">
          <!-- Logs will be inserted here -->
        </div>
      </div>
      
    </main>
    
    <!-- Bottom Navigation -->
    <nav class="absolute bottom-0 left-0 right-0 h-20 glass-card border-t flex items-center justify-around px-4"
         style="border-color: rgba(15,23,42,0.06);">
      <button onclick="switchTab('home')" class="nav-btn active flex flex-col items-center gap-1 py-2 px-4 rounded-xl transition btn-press">
        <i class="fa-solid fa-house text-lg text-cyan-600"></i>
        <span class="text-[10px] font-semibold text-cyan-700">홈</span>
        <span class="w-1 h-1 rounded-full bg-cyan-500"></span>
      </button>
      <button onclick="switchTab('sound')" class="nav-btn flex flex-col items-center gap-1 py-2 px-4 rounded-xl transition btn-press">
        <i class="fa-solid fa-sliders text-lg text-slate-400"></i>
        <span class="text-[10px] font-semibold text-slate-500">사운드</span>
        <span class="w-1 h-1 rounded-full bg-transparent"></span>
      </button>
      <button onclick="switchTab('filter')" class="nav-btn flex flex-col items-center gap-1 py-2 px-4 rounded-xl transition btn-press">
        <i class="fa-solid fa-wind text-lg text-slate-400"></i>
        <span class="text-[10px] font-semibold text-slate-500">필터/환기</span>
        <span class="w-1 h-1 rounded-full bg-transparent"></span>
      </button>
      <button onclick="switchTab('log')" class="nav-btn flex flex-col items-center gap-1 py-2 px-4 rounded-xl transition btn-press">
        <i class="fa-solid fa-shield text-lg text-slate-400"></i>
        <span class="text-[10px] font-semibold text-slate-500">보안 로그</span>
        <span class="w-1 h-1 rounded-full bg-transparent"></span>
      </button>
    </nav>
    
    <!-- Toast Container -->
    <div id="toast-container" class="absolute bottom-24 left-4 right-4 z-50"></div>
    
  </div>
  
  <script>
    // ========== STATE ==========
    let state = {
      mode: 'smart', // bunker, smart, open
      natureSound: false,
      autoOptimize: true,
      fanSpeed: 3,
      eq: { low: 50, mid: 60, high: 40 },
      values: {
        noiseOut: 82,
        noiseIn: 35,
        dustOut: 150,
        dustIn: 8
      },
      indicators: {
        noiseControl: 80,
        airPurity: 90,
        shieldIndex: 85
      },
      targets: {
        noiseControl: 80,
        airPurity: 90
      }
    };
    
    // Mode target ranges
    const modeTargets = {
      bunker: { noiseIn: [28, 33], dustIn: [3, 8], noiseControl: [92, 98], airPurity: [94, 100] },
      smart: { noiseIn: [33, 38], dustIn: [6, 12], noiseControl: [78, 88], airPurity: [82, 92] },
      open: { noiseIn: [46, 55], dustIn: [10, 22], noiseControl: [55, 70], airPurity: [60, 78] }
    };
    
    // ========== LOGS ==========
    let logs = [
      { time: '14:32', icon: 'fa-shield-halved', text: '외부 미세먼지 급증 감지', chip: '감지됨', chipColor: 'amber' },
      { time: '14:28', icon: 'fa-lock', text: '벙커 모드 자동 전환', chip: '전환됨', chipColor: 'indigo' },
      { time: '14:15', icon: 'fa-ban', text: '외부 소음 85dB 차단', chip: '차단됨', chipColor: 'red' },
      { time: '13:50', icon: 'fa-wand-magic-sparkles', text: '스마트 벤트 모드 활성화', chip: '활성화', chipColor: 'cyan' },
      { time: '13:20', icon: 'fa-leaf', text: '필터 자동 최적화 작동', chip: '최적화', chipColor: 'emerald' }
    ];
    
    function renderLogs() {
      const container = document.getElementById('log-list');
      container.innerHTML = logs.map(log => {
        const colors = {
          amber: 'rgba(245,158,11,0.1);color:#D97706',
          indigo: 'rgba(79,70,229,0.1);color:#4F46E5',
          red: 'rgba(239,68,68,0.1);color:#DC2626',
          cyan: 'rgba(6,182,212,0.1);color:#0891B2',
          emerald: 'rgba(16,185,129,0.1);color:#059669'
        };
        return `
          <div class="glass-card rounded-xl p-4 border flex items-center gap-3" style="border-color: rgba(15,23,42,0.06);">
            <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: ${colors[log.chipColor].split(';')[0]}">
              <i class="fa-solid ${log.icon}" style="${colors[log.chipColor].split(';')[1]}"></i>
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium text-slate-700">${log.text}</p>
              <span class="text-xs text-slate-400">[${log.time}]</span>
            </div>
            <span class="px-2 py-0.5 rounded-full text-[10px] font-semibold" style="background: ${colors[log.chipColor]}">${log.chip}</span>
          </div>
        `;
      }).join('');
    }
    
    function addLog(icon, text, chip, chipColor) {
      const now = new Date();
      const time = `${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
      logs.unshift({ time, icon, text, chip, chipColor });
      if (logs.length > 20) logs.pop();
      renderLogs();
    }
    
    // ========== TAB SWITCHING ==========
    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.getElementById(`tab-${tabName}`).classList.add('active');
      
      document.querySelectorAll('.nav-btn').forEach((btn, i) => {
        const tabs = ['home', 'sound', 'filter', 'log'];
        const isActive = tabs[i] === tabName;
        btn.classList.toggle('active', isActive);
        btn.querySelector('i').className = btn.querySelector('i').className.replace(/text-\w+-\d+/, isActive ? 'text-cyan-600' : 'text-slate-400');
        btn.querySelector('span:first-of-type').className = `text-[10px] font-semibold ${isActive ? 'text-cyan-700' : 'text-slate-500'}`;
        btn.querySelector('span:last-of-type').className = `w-1 h-1 rounded-full ${isActive ? 'bg-cyan-500' : 'bg-transparent'}`;
      });
    }
    
    // ========== MODE CONTROL ==========
    function setMode(mode) {
      if (state.mode === mode) return;
      state.mode = mode;
      
      // Update button styles
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.style.border = '1px solid rgba(15,23,42,0.08)';
        btn.style.boxShadow = 'none';
        btn.querySelector('i').className = btn.querySelector('i').className.replace(/text-\w+-\d+/, 'text-slate-600');
        btn.querySelector('div').className = 'text-xs font-semibold text-slate-600';
      });
      
      const activeBtn = document.getElementById(`mode-${mode === 'smart' ? 'smart' : mode === 'bunker' ? 'bunker' : 'open'}`);
      activeBtn.style.border = '2px solid #06B6D4';
      activeBtn.style.boxShadow = '0 0 0 3px rgba(6,182,212,0.15)';
      activeBtn.querySelector('i').className = activeBtn.querySelector('i').className.replace(/text-\w+-\d+/, 'text-cyan-600');
      activeBtn.querySelector('div').className = 'text-xs font-semibold text-cyan-700';
      
      // Update hero mode display
      const modeNames = { bunker: '벙커 모드', smart: '스마트 벤트', open: '안심 개방' };
      const modeIcons = { bunker: 'fa-lock', smart: 'fa-wand-magic-sparkles', open: 'fa-door-open' };
      const statusMessages = { 
        bunker: '완전 차단 유지 중', 
        smart: '실시간 최적화 중', 
        open: '환기 강화, 일부 유입 허용' 
      };
      
      document.getElementById('current-mode-label').textContent = modeNames[mode];
      document.getElementById('mode-icon-hero').className = `fa-solid ${modeIcons[mode]} text-xs text-cyan-600`;
      document.getElementById('status-message').textContent = statusMessages[mode];
      
      // Set new targets for indicators
      const targets = modeTargets[mode];
      state.targets.noiseControl = randomInRange(targets.noiseControl[0], targets.noiseControl[1]);
      state.targets.airPurity = randomInRange(targets.airPurity[0], targets.airPurity[1]);
      
      // Show toast
      showToast('fa-check-circle', `${modeNames[mode]} 활성화`);
      
      // Add log
      addLog('fa-sliders', `${modeNames[mode]}로 전환됨`, '전환됨', 'indigo');
      
      updateStatusLabels();
    }
    
    // ========== TOGGLES ==========
    function toggleNature() {
      state.natureSound = !state.natureSound;
      const btn = document.getElementById('toggle-nature');
      const knob = btn.querySelector('span');
      
      if (state.natureSound) {
        btn.style.background = '#06B6D4';
        knob.style.transform = 'translateX(20px)';
        showToast('fa-leaf', '자연음 패스스루 활성화');
        addLog('fa-leaf', '자연음 패스스루 켜짐', '활성화', 'emerald');
      } else {
        btn.style.background = 'rgba(15,23,42,0.1)';
        knob.style.transform = 'translateX(0)';
        showToast('fa-volume-xmark', '자연음 패스스루 비활성화');
        addLog('fa-volume-xmark', '자연음 패스스루 꺼짐', '비활성화', 'amber');
      }
      updateStatusLabels();
    }
    
    function toggleAuto() {
      state.autoOptimize = !state.autoOptimize;
      const btn = document.getElementById('toggle-auto');
      const knob = btn.querySelector('span');
      
      if (state.autoOptimize) {
        btn.style.background = '#06B6D4';
        knob.style.transform = 'translateX(20px)';
        showToast('fa-wand-magic-sparkles', '필터 자동 최적화 활성화');
        addLog('fa-wand-magic-sparkles', '필터 자동 최적화 켜짐', '활성화', 'cyan');
      } else {
        btn.style.background = 'rgba(15,23,42,0.1)';
        knob.style.transform = 'translateX(0)';
        showToast('fa-hand', '필터 자동 최적화 비활성화');
        addLog('fa-hand', '필터 자동 최적화 꺼짐', '비활성화', 'amber');
      }
    }
    
    // ========== SLIDERS ==========
    function updateFanSpeed(value) {
      state.fanSpeed = parseInt(value);
      document.getElementById('fan-level').textContent = `${value}단계`;
      
      // Update fan icon rotation speed
      const speeds = { 1: '4s', 2: '3s', 3: '2s', 4: '1.2s', 5: '0.6s' };
      document.getElementById('fan-icon').style.setProperty('--fan-speed', speeds[value]);
      
      showToast('fa-fan', `환기 팬 속도 ${value}단계`);
      addLog('fa-fan', `환기 팬 속도 ${value}단계로 변경`, '변경됨', 'cyan');
    }
    
    function updateEQ(band, value) {
      state.eq[band] = parseInt(value);
      document.getElementById(`eq-${band}-val`).textContent = value;
      
      // Update corresponding meter bars
      const baseHeight = 15 + (value * 0.3);
      const peakHeight = 30 + (value * 0.5);
      
      document.getElementById(`meter-${band}-1`).style.setProperty('--base-height', `${baseHeight}%`);
      document.getElementById(`meter-${band}-1`).style.setProperty('--peak-height', `${peakHeight}%`);
      document.getElementById(`meter-${band}-2`).style.setProperty('--base-height', `${baseHeight + 5}%`);
      document.getElementById(`meter-${band}-2`).style.setProperty('--peak-height', `${peakHeight + 10}%`);
    }
    
    // ========== TOAST ==========
    function showToast(icon, message) {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = 'toast-enter glass-card rounded-xl px-4 py-3 flex items-center gap-3 border shadow-lg';
      toast.style.borderColor = 'rgba(15,23,42,0.08)';
      toast.innerHTML = `
        <i class="fa-solid ${icon} text-cyan-600"></i>
        <span class="text-sm font-medium text-slate-700">${message}</span>
      `;
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.classList.remove('toast-enter');
        toast.classList.add('toast-exit');
        setTimeout(() => toast.remove(), 300);
      }, 2000);
    }
    
    // ========== STATUS LABELS ==========
    function updateStatusLabels() {
      const noiseStatus = document.getElementById('noise-status');
      const mode = state.mode;
      
      if (state.natureSound && mode === 'open') {
        noiseStatus.innerHTML = '<i class="fa-solid fa-leaf text-[8px]"></i> 자연음 허용';
        noiseStatus.style.background = 'rgba(16,185,129,0.1)';
        noiseStatus.style.color = '#059669';
      } else if (mode === 'bunker') {
        noiseStatus.innerHTML = '<i class="fa-solid fa-lock text-[8px]"></i> 완전 차음';
        noiseStatus.style.background = 'rgba(79,70,229,0.1)';
        noiseStatus.style.color = '#4F46E5';
      } else if (mode === 'open') {
        noiseStatus.innerHTML = '<i class="fa-solid fa-door-open text-[8px]"></i> 환기 우선';
        noiseStatus.style.background = 'rgba(245,158,11,0.1)';
        noiseStatus.style.color = '#D97706';
      } else {
        noiseStatus.innerHTML = '<i class="fa-solid fa-check-circle text-[8px]"></i> 차음 안정';
        noiseStatus.style.background = 'rgba(16,185,129,0.1)';
        noiseStatus.style.color = '#059669';
      }
    }
    
    // ========== REAL-TIME SIMULATION ==========
    function lerp(current, target, factor) {
      return current + (target - current) * factor;
    }
    
    function randomInRange(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    
    // Smooth indicator animation
    let animationFrame;
    function animateIndicators() {
      const lerpFactor = 0.08; // Smooth factor for ~500ms feel
      
      // Lerp towards targets
      state.indicators.noiseControl = lerp(state.indicators.noiseControl, state.targets.noiseControl, lerpFactor);
      state.indicators.airPurity = lerp(state.indicators.airPurity, state.targets.airPurity, lerpFactor);
      
      // Calculate Shield Index
      const targetShield = Math.round(0.55 * state.indicators.airPurity + 0.45 * state.indicators.noiseControl);
      state.indicators.shieldIndex = lerp(state.indicators.shieldIndex, targetShield, lerpFactor);
      
      // Update DOM
      updateIndicatorUI();
      
      animationFrame = requestAnimationFrame(animateIndicators);
    }
    
    function updateIndicatorUI() {
      const noise = Math.round(state.indicators.noiseControl);
      const air = Math.round(state.indicators.airPurity);
      const shield = Math.round(state.indicators.shieldIndex);
      
      // Update text values
      document.getElementById('noise-indicator').textContent = noise;
      document.getElementById('air-indicator').textContent = air;
      document.getElementById('shield-value').textContent = shield;
      
      // Update noise ring (circumference = 2 * π * 26 ≈ 163.36)
      const noiseOffset = 163.36 * (1 - noise / 100);
      document.getElementById('noise-ring').style.strokeDashoffset = noiseOffset;
      
      // Update air ring
      const airOffset = 163.36 * (1 - air / 100);
      document.getElementById('air-ring').style.strokeDashoffset = airOffset;
      
      // Update shield dial (conic gradient)
      document.getElementById('shield-dial').style.setProperty('--shield-progress', shield);
    }
    
    function updateValues() {
      const targets = modeTargets[state.mode];
      
      // OUT values (environment - slight fluctuation)
      state.values.noiseOut = randomInRange(78, 88);
      state.values.dustOut = randomInRange(120, 170);
      
      // IN values (based on mode targets)
      let noiseTarget = targets.noiseIn;
      let dustTarget = targets.dustIn;
      
      // Adjust for nature sound
      if (state.natureSound && state.mode === 'open') {
        noiseTarget = [noiseTarget[0] + 5, noiseTarget[1] + 8];
      }
      
      // Adjust for auto optimize
      if (state.autoOptimize && state.mode === 'smart') {
        dustTarget = [dustTarget[0], dustTarget[1] - 2];
      }
      
      state.values.noiseIn = randomInRange(noiseTarget[0], noiseTarget[1]);
      state.values.dustIn = randomInRange(dustTarget[0], dustTarget[1]);
      
      // Update DOM
      document.getElementById('noise-out').textContent = state.values.noiseOut;
      document.getElementById('noise-in').textContent = state.values.noiseIn;
      document.getElementById('dust-out').textContent = state.values.dustOut;
      document.getElementById('dust-in').textContent = state.values.dustIn;
      
      // Update dust status chip
      const dustStatus = document.getElementById('dust-status');
      if (state.values.dustIn <= 10) {
        dustStatus.innerHTML = '<i class="fa-solid fa-wind text-[8px]"></i> 좋음';
        dustStatus.style.background = 'rgba(6,182,212,0.1)';
        dustStatus.style.color = '#0891B2';
      } else if (state.values.dustIn <= 18) {
        dustStatus.innerHTML = '<i class="fa-solid fa-wind text-[8px]"></i> 보통';
        dustStatus.style.background = 'rgba(245,158,11,0.1)';
        dustStatus.style.color = '#D97706';
      } else {
        dustStatus.innerHTML = '<i class="fa-solid fa-exclamation-triangle text-[8px]"></i> 주의';
        dustStatus.style.background = 'rgba(239,68,68,0.1)';
        dustStatus.style.color = '#DC2626';
      }
      
      // Update indicator targets with slight variation
      const indicatorTargets = modeTargets[state.mode];
      let noiseControlTarget = indicatorTargets.noiseControl;
      let airPurityTarget = indicatorTargets.airPurity;
      
      // Nature sound affects noise control
      if (state.natureSound && state.mode === 'open') {
        noiseControlTarget = [noiseControlTarget[0] - 8, noiseControlTarget[1] - 5];
      }
      
      // Fan speed affects air purity (higher = more stable/better)
      const fanBonus = (state.fanSpeed - 3) * 2;
      airPurityTarget = [
        Math.min(100, airPurityTarget[0] + fanBonus),
        Math.min(100, airPurityTarget[1] + fanBonus)
      ];
      
      // Auto optimize reduces variation
      if (state.autoOptimize) {
        const midNoise = (noiseControlTarget[0] + noiseControlTarget[1]) / 2;
        const midAir = (airPurityTarget[0] + airPurityTarget[1]) / 2;
        noiseControlTarget = [midNoise - 2, midNoise + 2];
        airPurityTarget = [midAir - 2, midAir + 2];
      }
      
      state.targets.noiseControl = randomInRange(noiseControlTarget[0], noiseControlTarget[1]);
      state.targets.airPurity = randomInRange(airPurityTarget[0], airPurityTarget[1]);
    }
    
    // ========== INIT ==========
    function init() {
      renderLogs();
      
      // Initialize indicator targets
      const initialTargets = modeTargets['smart'];
      state.targets.noiseControl = randomInRange(initialTargets.noiseControl[0], initialTargets.noiseControl[1]);
      state.targets.airPurity = randomInRange(initialTargets.airPurity[0], initialTargets.airPurity[1]);
      
      // Start indicator animation loop
      animateIndicators();
      
      // Animate HEPA progress on load
      setTimeout(() => {
        document.getElementById('hepa-progress').style.strokeDashoffset = '67.86';
      }, 300);
      
      // Start real-time updates
      setInterval(updateValues, 1000 + Math.random() * 400);
      updateValues();
      
      // Initialize UI
      updateIndicatorUI();
    }
    
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
